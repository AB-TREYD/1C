# Процедуры 
## РазбитьСтроку(ПлюсовойКабель,КоличествоЖилПлюсовой,СечениеПлюсовой,ИсполнениеЖилыПлюсовой,МаркаКабеля,Марка,КоличествоЖил,Сечение,ИсполнениеЖилы,НилиПЕ,Напряжение,КоличествоПроволокВЖиле,КоличествоПроволокНа1Кат,КоличествоЗарядКатНаСтренге,Плоский,СечениеЭкрана,ЦветЖилы,ЕдиницаИзмеренияЗаказа,тип,Цвет) Экспорт
Разбивает строку номенклатуры на составные части

* Для Силового кабеля МаркаКабеляНачинаетсяССиловой(МаркаКабеля)
* Для контрольного МаркаКабеляНачинаетсяСКонтрольный(МаркаКабеля)
* Для NYM МаркаКабеляНачинаетсяСNYM(МаркаКабеля)
* Для МаркаКабеляНачинаетсяСДля(МаркаКабеля)
* Для провод СИП МаркаКабеляНачинаетсяСПроводСИП(МаркаКабеля)
* Для провод АПВ МаркаКабеляНачинаетсяСПроводАПВ(МаркаКабеля)
* Для провод МаркаКабеляНачинаетсяСПровод(МаркаКабеля)
* Для проволоки МаркаКабеляНачинаетсяСПроволока(МаркаКабеля)
* Для стренги  МаркаКабеляНачинаетсяССтренга(МаркаКабеля)
* Для шины МаркаКабеляНачинаетсяСШина(МаркаКабеля)
* Для катанки МаркаКабеляНачинаетсяСКатанка(МаркаКабеля)
* Для прутка [МаркаКабеляНачинаетсяСПруток](#маркакабеляначинаетсяспрутокмаркакабеля)(МаркаКабеля)


Кол_Жил                     = 0;  
КоличествоЖил               = 0;  
Напряжение                  = 0;  
Сечение                     = 0;  
КоличествоПроволокВЖиле     = 0;  
КоличествоПроволокНа1Кат    = 0;    
КоличествоЗарядКатНаСтренге = 0;  
СечениеЭкрана               = 0;    
КоличествоЖилПлюсовой       = 0;    
СечениеПлюсовой             = 0;  
Марка                       = "";    
ИсполнениеЖилы              = "";  
НилиПЕ                      = "";  
ЦветЖилы                    = "";  
ИсполнениеЖилыПлюсовой      = "";  
Цвет                        = "";  
Плоский                     = Ложь;  
Гибкий                      = Ложь;    
ПлюсовойКабель              = Ложь;   

<details>
	<summary>Код</summary>
 
```
	СтруктураНоменклатуры = Новый Структура;
	МаркаКабеля=СокрЛП(МаркаКабеля) ;
	Вхождение = Найти(МаркаКабеля, "EXPERt class");
	
	Если Вхождение > 0 Тогда  
		//Это эксперт класс:       
		Если СтрНайти(Нрег(МаркаКабеля),"expert class")>0 тогда			//+12,08,22
			Если СтрНайти(МаркаКабеля,Символ(174))>0 тогда
				ЭкспертКласс = сред(МаркаКабеля,Вхождение,15); //expert class +12,08,22            //ВЕТКА- РУДИМЕНТ
				МаркаКабеля = Лев(МаркаКабеля,Вхождение-1)+Прав(МаркаКабеля,СтрДлина(МаркаКабеля)-(Вхождение+14));	   //+12,08,22   
				ЭкспертКласс = Лев(ЭкспертКласс, 12);
			Иначе  
				ЭкспертКласс = сред(МаркаКабеля,Вхождение,12); //23,09         Ставцев
				МаркаКабеля = Лев(МаркаКабеля,Вхождение-1)+Прав(МаркаКабеля,СтрДлина(МаркаКабеля)-(Вхождение+12));	      
				ЭкспертКласс = Лев(ЭкспертКласс, 12);   //Не нужная строчка?
			КонецЕсли;
		КонецЕсли;
		НеЭкспертКласс = Ложь;  	                                          			
	Иначе
		НеЭкспертКласс = Истина;
	КонецЕсли;	
	
	Если СтрНачинаетсяС(МаркаКабеля,"Кабель") Тогда		//Если кабель силовой   +
		МаркаКабеля=СтрЗаменить(МаркаКабеля,"Кабель","");
		МаркаКабеля=СокрЛП(МаркаКабеля) ;
		//		Если (СтрНачинаетсяС(МаркаКабеля,"силовой") и СтрНайти(МаркаКабеля,"6,0кВ")=0) и СтрНайти(МаркаКабеля,"NYM")=0 Тогда  //+
		
		Если (СтрНачинаетсяС(МаркаКабеля,"силовой") и СтрНайти(МаркаКабеля,"-6")=0) и СтрНайти(МаркаКабеля,"NYM")=0 Тогда  //+
			
			//ПОМЕНЯТЬ ТУТ 6.0кв на "-6" 22,09
			СтруктураНоменклатуры = МаркаКабеляНачинаетсяССиловой(МаркаКабеля);           
			Тип = СтруктураНоменклатуры.ТипПродукции; //+09,11,22			
			Марка = СтруктураНоменклатуры.Марка; 
			КоличествоЖил = СтруктураНоменклатуры.КоличествоЖил;
			Сечение = СтруктураНоменклатуры.Сечение;
			ИсполнениеЖилы = СтруктураНоменклатуры.Исполнение;
			НилиПЕ = СтруктураНоменклатуры.npe; 
			Цвет = СтруктураНоменклатуры.Цвет; //Цвет для маркировки может быть удалить
			Напряжение = СтруктураНоменклатуры.Напряжение;
			СечениеЭкрана = СтруктураНоменклатуры.СечениеЭкрана;
			ПлюсовойКабель = СтруктураНоменклатуры.ПлюсовойКабель;  
			Если ПлюсовойКабель = Истина Тогда
				КоличествоЖилПлюсовой = СтруктураНоменклатуры.КоличествоЖилПлюсовой;  
				СечениеПлюсовой = СтруктураНоменклатуры.СечениеПлюсовой; 
				ИсполнениеЖилыПлюсовой = СтруктураНоменклатуры.ИсполнениеЖилыПлюсовой;
				Марка = Строка(Марка + " " + КоличествоЖил + "x" + Сечение + "+" + КоличествоЖилПлюсовой + "x" + Число(СечениеПлюсовой));
			КонецЕсли;			
		ИначеЕсли СтрНачинаетсяС(МаркаКабеля,"контрольный") Тогда	  // Если контрольный  +
			СтруктураНоменклатуры = МаркаКабеляНачинаетсяСКонтрольный(МаркаКабеля);
			
			Тип = СтруктураНоменклатуры.ТипПродукции; //+09,11,22
			Марка = СтруктураНоменклатуры.Марка; 
			КоличествоЖил = СтруктураНоменклатуры.КоличествоЖил;
			Сечение = СтруктураНоменклатуры.Сечение;
			ИсполнениеЖилы = СтруктураНоменклатуры.Исполнение;
			НилиПЕ = СтруктураНоменклатуры.npe;
			Цвет = СтруктураНоменклатуры.Цвет; //Цвет для маркировки может быть удалить
			Напряжение = СтруктураНоменклатуры.Напряжение;
			СечениеЭкрана = СтруктураНоменклатуры.СечениеЭкрана;		
		ИначеЕсли СтрНайти(МаркаКабеля,"NYM")>0 Тогда	  // Если NYM 						/////ВЕТКА НЕ ПРОВЕРЕНА///// 
			МаркаКабеля=СтрЗаменить(МаркаКабеля,"силовой",""); 
			МаркаКабеля=СокрЛП(МаркаКабеля) ;
			СтруктураНоменклатуры = МаркаКабеляНачинаетсяСNYM(МаркаКабеля);
						Тип = СтруктураНоменклатуры.ТипПродукции; //+09,11,22

			Марка = СтруктураНоменклатуры.Марка;
			Цвет = СтруктураНоменклатуры.Цвет;  //Цвет для маркировки может быть удалить
			КоличествоЖил = СтруктураНоменклатуры.КоличествоЖил;
			Сечение = СтруктураНоменклатуры.Сечение;
			ИсполнениеЖилы = СтруктураНоменклатуры.Исполнение;
			НилиПЕ = СтруктураНоменклатуры.npe;
			Напряжение = СтруктураНоменклатуры.Напряжение; 				
		ИначеЕсли СтрНачинаетсяС(МаркаКабеля,"для") Тогда	  // Если для ОКЛ	+		
			СтруктураНоменклатуры = МаркаКабеляНачинаетсяСДля(МаркаКабеля);
			Тип = СтруктураНоменклатуры.ТипПродукции; //+09,11,22
			
			Марка = СтруктураНоменклатуры.Марка;
			Цвет = СтруктураНоменклатуры.Цвет; //Цвет для маркировки может быть удалить
			КоличествоЖил = СтруктураНоменклатуры.КоличествоЖил;
			Сечение = СтруктураНоменклатуры.Сечение;
			ИсполнениеЖилы = СтруктураНоменклатуры.Исполнение;
			НилиПЕ = СтруктураНоменклатуры.npe;
			Напряжение = СтруктураНоменклатуры.Напряжение; 			
		ИначеЕсли  СтрНайти(МаркаКабеля,"6,0кВ")>0 или СтрНайти(МаркаКабеля,"-6")>0 Тогда 				//+ 
			
			//ПОМЕНЯТЬ ТУТ 6.0кв на "-6"
			СтруктураНоменклатуры = МаркаКабеляНачинаетсяССиловой(МаркаКабеля);
			Тип = СтруктураНоменклатуры.ТипПродукции; //+09,11,22
			
			Марка = СтруктураНоменклатуры.Марка; 
			КоличествоЖил = СтруктураНоменклатуры.КоличествоЖил;
			Цвет = СтруктураНоменклатуры.Цвет; //Цвет для маркировки может быть удалить
			Сечение = СтруктураНоменклатуры.Сечение;
			ИсполнениеЖилы = СтруктураНоменклатуры.Исполнение;
			НилиПЕ = СтруктураНоменклатуры.npe;
			Напряжение = СтруктураНоменклатуры.Напряжение;
			СечениеЭкрана = СтруктураНоменклатуры.СечениеЭкрана;
		КонецЕсли;
	ИначеЕсли СтрНачинаетсяС(МаркаКабеля,"Провод") и не СтрНачинаетсяС(МаркаКабеля,"Провод МГ 35") и не СтрНайти(МаркаКабеля,"прогревочный") Тогда	  // Если Провод  +
		Если СтрНайти(МаркаКабеля, "СИП")>0 Тогда
			СтруктураНоменклатуры = МаркаКабеляНачинаетсяСПроводСИП(МаркаКабеля);							
			ПлюсовойКабель = СтруктураНоменклатуры.ПлюсовойКабель; 
		ИначеЕсли СтрНайти(МаркаКабеля, "АПВ") тогда
			СтруктураНоменклатуры = МаркаКабеляНачинаетсяСПроводАПВ(МаркаКабеля);	
 		Иначе
			СтруктураНоменклатуры = МаркаКабеляНачинаетсяСПровод(МаркаКабеля);
		КонецЕсли;
		Тип = СтруктураНоменклатуры.ТипПродукции; //+09,11,22
		Марка = СтруктураНоменклатуры.Марка; 
		КоличествоЖил = СтруктураНоменклатуры.КоличествоЖил;
		Сечение = СтруктураНоменклатуры.Сечение;
		Цвет = СтруктураНоменклатуры.Цвет; //Цвет для маркировки может быть удалить
		ИсполнениеЖилы = СтруктураНоменклатуры.Исполнение;
		НилиПЕ = СтруктураНоменклатуры.npe;
		Напряжение = СтруктураНоменклатуры.Напряжение;
		Если ПлюсовойКабель = Истина Тогда
			КоличествоЖилПлюсовой = СтруктураНоменклатуры.КоличествоЖилПлюсовой;  
			СечениеПлюсовой = СтруктураНоменклатуры.СечениеПлюсовой; 
			ИсполнениеЖилыПлюсовой = СтруктураНоменклатуры.ИсполнениеЖилыПлюсовой;
			Марка = Строка(Марка + " " + КоличествоЖил + "x" + Сечение + "+" + КоличествоЖилПлюсовой + "x" + Число(СечениеПлюсовой));
		КонецЕсли;
	ИначеЕсли СтрНачинаетсяС(МаркаКабеля,"Проволока медная") Тогда	  // Если Провод 	
		СтруктураНоменклатуры = МаркаКабеляНачинаетсяСПроволока(МаркаКабеля);
		Тип = СтруктураНоменклатуры.ТипПродукции; //+09,11,22
		Марка = СтруктураНоменклатуры.Марка; 
		КоличествоЖил = СтруктураНоменклатуры.КоличествоЖил;
		Сечение = СтруктураНоменклатуры.Сечение;
		Цвет = СтруктураНоменклатуры.Цвет; //Цвет для маркировки может быть удалить
		ИсполнениеЖилы = СтруктураНоменклатуры.Исполнение;
		НилиПЕ = СтруктураНоменклатуры.npe;
		Напряжение = СтруктураНоменклатуры.Напряжение;
	ИначеЕсли СтрНачинаетсяС(МаркаКабеля,"Стренга") Тогда	  // Если Стренга
		//Стренга медная ТПЖ 64х0,327	
		СтруктураНоменклатуры = МаркаКабеляНачинаетсяССтренга(МаркаКабеля);
		Тип = СтруктураНоменклатуры.ТипПродукции; //+09,11,22
		Марка = СтруктураНоменклатуры.Марка; 
		Цвет = СтруктураНоменклатуры.Цвет; //Цвет для маркировки может быть удалить
		КоличествоЖил = СтруктураНоменклатуры.КоличествоЖил;
		Сечение = СтруктураНоменклатуры.Сечение;
		ИсполнениеЖилы = СтруктураНоменклатуры.Исполнение;
		НилиПЕ = СтруктураНоменклатуры.npe;
		Напряжение = СтруктураНоменклатуры.Напряжение;
	ИначеЕсли СтрНачинаетсяС(МаркаКабеля, "Шина") Тогда	  // Если Шина	//Минайкин 21.08.2023	
		СтруктураНоменклатуры = МаркаКабеляНачинаетсяСШина(МаркаКабеля); 
		Тип           = СтруктураНоменклатуры.ТипПродукции; 
		Марка         = СтруктураНоменклатуры.Марка;
		КоличествоЖил = СтруктураНоменклатуры.ВысотаШины; 
		Сечение       = СтруктураНоменклатуры.ШиринаШины;
	ИначеЕсли СтрНачинаетсяС(МаркаКабеля,"Катанка") Тогда
		СтруктураНоменклатуры = МаркаКабеляНачинаетсяСКатанка(МаркаКабеля); 
		Тип           = СтруктураНоменклатуры.ТипПродукции; 
		Марка         = СтруктураНоменклатуры.Марка; 
		Сечение       = СтруктураНоменклатуры.Сечение;
	ИначеЕсли СтрНачинаетсяС(МаркаКабеля,"Пруток") Тогда
		СтруктураНоменклатуры = МаркаКабеляНачинаетсяСПруток(МаркаКабеля); 
		Тип           = СтруктураНоменклатуры.ТипПродукции; 
		Марка         = СтруктураНоменклатуры.Марка; 
		Сечение       = СтруктураНоменклатуры.Сечение;	
	ИначеЕсли СтрНачинаетсяС(МаркаКабеля,"Провод МГ 35") Тогда
		Марка = "МГ 35";		
	Иначе  Сообщить("Надо дописать функцию");
		Марка = МаркаКабеля;	
	КонецЕсли;   
	
	Если НеЭкспертКласс = Ложь Тогда
		МаркаКабеля = ЭкспертКласс;
	Иначе
		Попытка
			//Если СтрНайти(МаркаКабеля, "Г")>0 Тогда
			//	МаркаКабеля = Сред(МаркаКабеля, СтрНайти(МаркаКабеля, "Г"), СтрДлина(МаркаКабеля)-Счетчик);
			//Иначе
			//	МаркаКабеля = Сред(МаркаКабеля, СтрНайти(МаркаКабеля, "Т"), СтрДлина(МаркаКабеля)-Счетчик);
			//КонецЕсли;
			Для Счетчик = 1 по СтрДлина(МаркаКабеля) цикл
				Если Сред(МаркаКабеля,Счетчик,1) = "Г" или Сред(МаркаКабеля,Счетчик,1) = "Т" или Сред(МаркаКабеля,Счетчик,1) = "к" Тогда
					МаркаКабеля = Прав(МаркаКабеля,СтрДлина(МаркаКабеля)-Счетчик+1); //тут с пробелом
					МаркаКабеля = СтрЗаменить(МаркаКабеля, Символы.НПП, ""); //не убирает пробелы при копировании из Excel 				                                  
					//время позднее, а сроки горят, так что извиняйте...
					Если МаркаКабеля = "ГОСТ 1" тогда
						МаркаКабеля = "ГОСТ1";
					ИначеЕсли МаркаКабеля = "ГОСТ1" тогда
						МаркаКабеля = "ГОСТ1";
					ИначеЕсли МаркаКабеля = "ГОСТ01" тогда    
						МаркаКабеля = "ГОСТ 01"; 
					ИначеЕсли МаркаКабеля = "ГОСТ 01" тогда 
						МаркаКабеля = "ГОСТ 01";
					ИначеЕсли МаркаКабеля = "ГОСТ2" тогда
						МаркаКабеля = "ГОСТ2";
					ИначеЕсли МаркаКабеля = "ГОСТ3" тогда
						МаркаКабеля = "ГОСТ3";
					ИначеЕсли МаркаКабеля = "ГОСТ 2" тогда
						МаркаКабеля = "ГОСТ2";
					ИначеЕсли МаркаКабеля = "ГОСТ 2 разномер" тогда
						МаркаКабеля = "ГОСТ2";	
					ИначеЕсли МаркаКабеля = "ГОСТ 3" тогда
						МаркаКабеля = "ГОСТ3";
					ИначеЕсли МаркаКабеля = "ТУ 1" тогда
						МаркаКабеля = "ТУ1";
					ИначеЕсли МаркаКабеля = "ТУ 2" тогда
						МаркаКабеля = "ТУ2";
					ИначеЕсли МаркаКабеля = "ГОСТ 001" тогда  						
						МаркаКабеля = "ГОСТ 001";
					ИначеЕсли МаркаКабеля = "красный" тогда
						МаркаКабеля = "ГОСТ3";
					ИначеЕсли МаркаКабеля = "ТУ 3 красные" тогда
						МаркаКабеля = "ГОСТ3";
					ИначеЕсли МаркаКабеля = "ТУ 3 красный" тогда
						МаркаКабеля = "ГОСТ3";						
					Иначе
					КонецЕсли;				
					Прервать;
				Иначе
					ОстатокОтМарки=МаркаКабеля; //Если попал сюда значит разбился как-то криво, сохраняем в отдельную переменную т.к. в дальнейшем сможем посмотреть что не так
					Если СтрНайти(МаркаКабеля, "ГОСТ")>0 Тогда
						МаркаКабеля = "ГОСТ";
					Иначе
						МаркаКабеля = "";
					КонецЕсли;
				КонецЕсли;			
			КонецЦикла;	
		Исключение
		КонецПопытки;
	КонецЕсли;
	
	Возврат МаркаКабеля;      //МаркаКабеля = вариант исполнения (в конце должен остаться)
```

</details>

## МаркаКабеляНачинаетсяСПруток(МаркаКабеля)
Разбивает пруток на составные части

МаркаКабеля - Строка;

<details>
	<summary>Код</summary>
	
```
	СтруктураНоменклатуры = Новый Структура;
	
	//Тип
	Тип = Перечисления.ТипПродукции.Пруток;
	
	МаркаКабеля = СокрЛ(СтрЗаменить(МаркаКабеля, "Пруток", "")); 
	
	//Марка
	ПробелМеждуМаркойИСечением = СтрНайти(МаркаКабеля, "Ø", НаправлениеПоиска.СНачала);
	
	Марка = Лев(МаркаКабеля, ПробелМеждуМаркойИСечением - 2);
	
	МаркаКабеля = СокрЛ(СтрЗаменить(МаркаКабеля, Марка, ""));
	
	МаркаКабеля = СокрЛ(СтрЗаменить(МаркаКабеля, "Ø", "")); 
	
	//Сечение 
	ПробелМеждуМаркойИСечением = СтрНайти(МаркаКабеля, " ", НаправлениеПоиска.СНачала);
	
	Сечение = Лев(МаркаКабеля, ПробелМеждуМаркойИСечением - 1);
	
	МаркаКабеля = СокрЛ(СтрЗаменить(МаркаКабеля, Сечение, ""));
	//Вариант исполнения
	ПробелМеждуМаркойИСечением = СтрНайти(МаркаКабеля, " ", НаправлениеПоиска.СНачала);
	
	Если ПробелМеждуМаркойИСечением <> 0 Тогда 
		МаркаКабеля = Лев(МаркаКабеля, ПробелМеждуМаркойИСечением - 1);	
	КонецЕсли;                                                           
	
	СтруктураНоменклатуры.Вставить("Марка",             Марка);
	СтруктураНоменклатуры.Вставить("ТипПродукции",      Тип);
	СтруктураНоменклатуры.Вставить("Сечение",           Сечение);
	СтруктураНоменклатуры.Вставить("ВариантИсполнения", МаркаКабеля);
	
	Возврат СтруктураНоменклатуры;
```
</details>
