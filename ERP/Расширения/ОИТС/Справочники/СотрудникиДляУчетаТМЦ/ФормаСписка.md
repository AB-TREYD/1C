# Процедуры

## Процедура СписокПередУдалением(Элемент, Отказ)
Проверка и удаление элемента списка.

```
Для Каждого ИндексСтроки Из Элементы.Список.ВыделенныеСтроки Цикл
    Результат = ЗапросИзДокумента(ИндексСтроки);
    Если НЕ ТипЗнч(Результат) = Тип("Булево") Тогда
        СписокПередУдалениемНаСервере(Результат); 
    ИначеЕсли Результат = Ложь Тогда
        Отказ = Истина;
        Сообщить("Прежде чем удалить сотрудника " + Строка(ИндексСтроки) + " из списка, необходимо вернуть все товары, которые закреплены за ним, обратно на склад!"); 
    КонецЕсли;	
КонецЦикла;
```

## Процедура СписокПередУдалениемНаСервере(Результат)

```
ДокументНаУдаление = Результат.ПолучитьОбъект();
ДокументНаУдаление.Удалить();
```

# Функции 

## Функция ЗапросИзДокумента(ФИО)
Запрос для проверки возможности удаления.

<details>
<summary>Код</summary>

	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	УчетОтработанныхРанееТМЦТовары.НомерСтроки КАК НомерСтроки,
		|	УчетОтработанныхРанееТМЦ.Ссылка КАК Ссылка
		|ИЗ
		|	Документ.УчетОтработанныхРанееТМЦ.Товары КАК УчетОтработанныхРанееТМЦТовары
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.УчетОтработанныхРанееТМЦ КАК УчетОтработанныхРанееТМЦ
		|		ПО УчетОтработанныхРанееТМЦТовары.Ссылка = УчетОтработанныхРанееТМЦ.Ссылка
		|ГДЕ
		|	УчетОтработанныхРанееТМЦТовары.Ссылка.ФИО = &ФИО";
	
	Запрос.УстановитьПараметр("ФИО", ФИО);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если РезультатЗапроса.Выгрузить().Количество() > 0 Тогда
		Результат = Ложь;
	Иначе 
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "УчетОтработанныхРанееТМЦТовары.НомерСтроки КАК НомерСтроки,", "");
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Документ.УчетОтработанныхРанееТМЦ.Товары КАК УчетОтработанныхРанееТМЦТовары
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.УчетОтработанныхРанееТМЦ КАК УчетОтработанныхРанееТМЦ
		|		ПО УчетОтработанныхРанееТМЦТовары.Ссылка = УчетОтработанныхРанееТМЦ.Ссылка", "Документ.УчетОтработанныхРанееТМЦ КАК УчетОтработанныхРанееТМЦ");
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "УчетОтработанныхРанееТМЦТовары.Ссылка.ФИО = &ФИО", "УчетОтработанныхРанееТМЦ.ФИО = &ФИО");
		Запрос.УстановитьПараметр("ФИО", ФИО);
		РезультатЗапроса = Запрос.Выполнить();
		Если РезультатЗапроса.Выгрузить().Количество() > 0 Тогда 
			Результат = РезультатЗапроса.Выгрузить()[0].Ссылка;
		Иначе 
			Результат = Истина;
		КонецЕсли;
	КонецЕсли;
	
	Возврат Результат;	    
</details>


