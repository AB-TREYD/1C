# Процедуры

## Процедура ЗаписьВРегистрСведений(ДокСсылка, Товар, Вариант, СсылкаНаПотребление = "", ИзменениеВремени = "") Экспорт 
Процедура создает запись в регистре сведений "Фиксация изменений". 

Вызывается при любом действии с товарами (Передача, ремонт, сборка и тд).
<details>
<summary> Код </summary>
        
        НаборЗаписей = РегистрыСведений.ФиксацияИзменений.СоздатьНаборЗаписей();
        НаборЗаписей.Отбор.Регистратор.Установить(ДокСсылка); 
        НаборЗаписей.Прочитать();
        НоваяЗапись = НаборЗаписей.Добавить();
        Если ТипЗнч(ИзменениеВремени) = Тип("Число") Тогда
        		//Для Сборки в СсылкаНаПотребление передается число
        		НоваяЗапись.Дата = ТекущаяДата() - ИзменениеВремени;
        	Иначе	
        		НоваяЗапись.Дата = ТекущаяДата();
        	КонецЕсли;
        	НоваяЗапись.СерийныйНомер = Товар.СерийныйНомер;
        	НоваяЗапись.Количество = Товар.Количество;
        	НоваяЗапись.Номенклатура = Товар.Номенклатура;
        	Если СсылкаНаПотребление = "" ИЛИ  ТипЗнч(ИзменениеВремени) = Тип("Число") Тогда 
        		НоваяЗапись.ДокументыРедактирования = Документы.ВнутреннееПотребление.ПустаяСсылка();
        	Иначе
        		НоваяЗапись.ДокументыРедактирования = СсылкаНаПотребление;
        	КонецЕсли;
        	Если Вариант = "Передача" Тогда
        		НоваяЗапись.Статус = Перечисления.ВариантыСкладскогоУчета.ПередалиВЭксплуатацию;
        	ИначеЕсли Вариант = "Списание" Тогда
        		НоваяЗапись.Статус = Перечисления.ВариантыСкладскогоУчета.СписалиНаРасходы;
        	ИначеЕсли Вариант = "ОтработанРанее" Тогда
        		НоваяЗапись.Статус = Перечисления.ВариантыСкладскогоУчета.ОтработанРанее;
        	ИначеЕсли Вариант = "Отменили" Тогда
        		НоваяЗапись.Статус = Перечисления.ВариантыСкладскогоУчета.Отменили;
        	ИначеЕсли Вариант = "ВернулиИзЭксплуатации" Тогда
        		НоваяЗапись.Статус = Перечисления.ВариантыСкладскогоУчета.ВернулиИзЭксплуатации;
        	ИначеЕсли Вариант = "ВернулиОтработанРанее" Тогда 
        		НоваяЗапись.Статус = Перечисления.ВариантыСкладскогоУчета.Вернули_ОтработанРанее;
        	ИначеЕсли Вариант = "ИспользовалиДляСборки" Тогда
        		НоваяЗапись.Статус = Перечисления.ВариантыСкладскогоУчета.ИспользовалиДляСборки;
        	ИначеЕсли Вариант = "СписалиНаРасходы_Ремонт" Тогда
        		НоваяЗапись.Статус = Перечисления.ВариантыСкладскогоУчета.СписалиНаРасходы_Ремонт;
        	КонецЕсли;
        	Если НЕ ТипЗнч(ДокСсылка) = Тип("ДокументСсылка.СборкаТоваров") Тогда		
        		НоваяЗапись.ФИО  = ДокСсылка.ФИО;    
        	КонецЕсли;
        	НоваяЗапись.ТекущийПользователь = Пользователи.ТекущийПользователь(); 
        	НаборЗаписей.Записать();
</details>
