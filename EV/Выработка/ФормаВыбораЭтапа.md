
##
<details>
  <summary>
    Код  </summary>


</details>

## &НаКлиенте Процедура Выбрать(Команда)    


 <details>
   <summary>
 Код  </summary>
   
	ТД=ТекущийЭлемент.ТекущиеДанные;
	Результат = Новый Структура;                                                          
	Результат.Вставить("Оборудование", 					ТД.НазваниеОборудования); 
	Результат.Вставить("ВидОперации", 					ТД.ВидОперации); 
	Результат.Вставить("НомерЭтапа", 					ТД.НомерЭтапа);                 
	Результат.Вставить("НомерОперации", 				ТД.НомерОперации);
	Результат.Вставить("ЗатратыВремениНаОперацию", 		ТД.ЗатратыВремениНаОперацию);
	Результат.Вставить("ВремяВыполненияЗаказаМинут", 	ТД.ВремяВыполненияЗаказаМинут);
	Результат.Вставить("РасчетноеВремяЗапуска", 		ТД.РасчетноеВремяЗапуска);
	Результат.Вставить("РасчетноеВремяОкончанияЭтапа", 	ТД.РасчетноеВремяОкончанияЭтапа);
	Результат.Вставить("Материал1", 					ТД.Материал1);
	Результат.Вставить("Материал2", 					ТД.Материал2);
	Результат.Вставить("Материал3", 					ТД.Материал3);
	Результат.Вставить("Материал4", 					ТД.Материал4);
	Результат.Вставить("Материал5", 					ТД.Материал5);   
	Результат.Вставить("ВыбранныйБарабан", 				ТД.ВыбранныйБарабан);
	Результат.Вставить("IDZak", ЭтаФорма.IDZak);   
	Результат.Вставить("Сечение",ТД.Сечение);
	//+06.03.2023 Яковлев А.
	Если 	Строка(ТД.НазваниеОборудования) = "Экструзионная линия № 001 ХМ 90/25" 
		или Строка(ТД.НазваниеОборудования) = "Экструзионная линия № 009 ХМ 70/25" Тогда
		//70 или 90 пресс, расчеты производятся в отдельной форме
		Результат.Вставить("НомерСчета",ЭтотОбъект.НомерСчета);
		Результат.Вставить("ПлюсовойКабель",ТД.ПлюсовойКабель);   
		Результат.Вставить("Фио",ЭтаФорма.Фио);
		Результат.Вставить("НомерОперации",ТД.НомерОперации);         
		Результат.Вставить("ГрупповойРезерв",ЭтаФорма.ГрупповойРезерв); 
		Результат.Вставить("СсылкаНаЗаказ",ЭтаФорма.СсылкаНаЗаказ); 
		
		Форма = ПолучитьФорму("Документ.Выработка.Форма.Пресс70или90", Результат);    	
		РезФормы=Форма.ОткрытьМодально();	
		Если не РезФормы=неопределено тогда
			Если РезФормы.Свойство("ОбщееКолвоКМ") тогда
				Результат.Вставить("ОбщееКолвоКМ",							РезФормы.ОбщееКолвоКМ);
				Результат.Вставить("Цена",									РезФормы.Цена); 
				Результат.Вставить("Разряд",								РезФормы.Разряд);
				Результат.Вставить("КоэфСмены",								РезФормы.КоэфСмены);
				Результат.Вставить("РасценкаЗаСменуПластиката",				РезФормы.РасценкаЗаСменуПластиката);
				
				Результат.Вставить("ГрупповойРезерв",						РезФормы.ГрупповойРезерв);         
				Результат.Вставить("РасценкаЗаСменуЦвета",					РезФормы.РасценкаЗаСменуЦвета);         
				Результат.Вставить("РасценкаЗаСменуИнструмента",			РезФормы.РасценкаЗаСменуИнструмента);         
				Результат.Вставить("КоэффициентЗагруженностиОборудования",	РезФормы.КоэфЗагрОб);
			КонецЕсли;   
		иначе
			Результат=Неопределено;
 		КонецЕсли;
  	КонецЕсли;
	
	Закрыть(Результат);

</details>

## &НаСервере Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)      

 <details>
   <summary>
 Код  </summary>


	Если Параметры.Свойство("СсылкаНаЗаказ") тогда
		ЭтаФорма.СсылкаНаЗаказ = Параметры.СсылкаНаЗаказ;
	КонецЕсли;
		
	//Для определения номера операции
	Волочение	  								=0;
	ВолочениеМультивайер                        =0;
	СкруткаТПЖ                                  =0;
	СкруткаСтренги                              =0;               
	ОбщаяСкрутка               	                =0;
	ОбщаяСкрутка6кВ                             =0;
	Заполнение                                  =0;
	ОболочкаПлоский                             =0;
	ОболочкаКруглый                             =0;
	Изоляция                                    =0;
	Изоляция3слоя                               =0;
	ОбмоткаАлюмофлексом                         =0;
	Обмотка1Слой                                =0;
	Обмотка2Слоя                                =0;
	ОбмоткаБроней                               =0;
	ОбмоткаПроволочнойБронёй                    =0;
	ОбмоткаПроволочнымЭкраном                   =0;
	ЗаполнениеИОболочка                         =0; 
	ОболочкаШлангом								=0;
	ОболочкаПлоскийШлангом						=0;
	Если НомерСчета="" тогда                           
		//+10.04.2024
		НомерСчета=СсылкаНаЗаказ.НомерСчета;		
		//-10.04.2024
		Если Параметры.Свойство("ГрупповойРезерв") тогда
			ГрупповойРезерв=Параметры.ГрупповойРезерв;	
		Иначе
			ГрупповойРезерв=Ложь;
		КонецЕсли;                   
		Если параметры.Свойство("Фио") тогда
			фио=Параметры.Фио;	                 
			этаФорма.Фио=Фио;                   
		КонецЕсли;
	КонецЕсли;
	ЭтаФорма.НомерСчета=НомерСчета;
		
	Элементы.ТаблЧастьПлюсовойКабель.Видимость = СсылкаНаЗаказ.ПлюсовойКабель; 
	Для каждого Этап из СсылкаНаЗаказ.ЭтапыИОборудование цикл		
		НовСтр=ЭтаФорма.ТаблЧасть.Добавить();    
		ЗаполнитьЗначенияСвойств(НовСтр,Этап);
	      
		//Определяем плюсовое/основное сечение
		
		Перечис_Плюс = Перечисления.ОсновнойПлюсовойСуммарный;
		Если Этап.ВидОперации = Перечисления.ВидОперации.Изоляция тогда
			Если Этап.ПлюсовойКабель = Перечис_Плюс.ПустаяСсылка() или Этап.ПлюсовойКабель = Перечис_Плюс.Основной тогда
				НовСтр.Сечение="1х"+Строка(СсылкаНаЗаказ.Сечение);						
			ИначеЕсли Этап.ПлюсовойКабель=Перечис_Плюс.Плюсовой тогда
				НовСтр.Сечение="1х"+Строка(СсылкаНаЗаказ.СечениеПлюсовой);						
			КонецЕсли;
		иначе                                             
			НовСтр.Сечение = СсылкаНаЗаказ.МаркаЗаказаИзЕРП;		
		КонецЕсли;  			
		Если Этап.ПлюсовойКабель = Перечис_Плюс.Плюсовой Тогда
			НовСтр.ДиаметрПроволоки=СсылкаНаЗаказ.ДиаметрПроволокиПлюсовой;
			НовСтр.ДиаметрПроволокиДляПотребностиВМеталле=СсылкаНаЗаказ.ДиаметрПроволокиДляПотребностиВМеталлеПлюсовой;	
		Иначе
			НовСтр.ДиаметрПроволоки=СсылкаНаЗаказ.ДиаметрПроволоки;
			НовСтр.ДиаметрПроволокиДляПотребностиВМеталле=СсылкаНаЗаказ.ДиаметрПроволокиДляПотребностиВМеталле;	
		КонецЕсли;
		ЭтаФорма.IDZak= СсылкаНаЗаказ.IDZak;
		//ЭтаФорма.СсылкаНаЗаказ = Этап.ссылка; Потом переделать под этот вариант!!!!!!!!
		#Область НомерОперации				
		Если Этап.ВидОперации=Перечисления.ВидОперации.ВолочениеМультивайер тогда
			ВолочениеМультивайер=ВолочениеМультивайер+1;
			НовСтр.НомерОперации = ВолочениеМультивайер;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.Волочение			
			тогда	       
			Волочение=Волочение+1;
			НовСтр.НомерОперации = Волочение;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.СкруткаТПЖ 		
			тогда		
			СкруткаТПЖ=СкруткаТПЖ+1;			
			НовСтр.НомерОперации = СкруткаТПЖ;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.СкруткаСтренги 	
			тогда         
			СкруткаСтренги=СкруткаСтренги+1; 
			НовСтр.НомерОперации = СкруткаСтренги;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ОбщаяСкрутка      
			тогда            
			ОбщаяСкрутка=ОбщаяСкрутка+1;         
			НовСтр.НомерОперации = ОбщаяСкрутка;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ОбщаяСкрутка6кВ     
			тогда          
			ОбщаяСкрутка6кВ=ОбщаяСкрутка6кВ+1;
			НовСтр.НомерОперации = ОбщаяСкрутка6кВ;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ОбмоткаАлюмофлексом  
			тогда        
			ОбмоткаАлюмофлексом=ОбмоткаАлюмофлексом+1;
			НовСтр.НомерОперации = ОбмоткаАлюмофлексом;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.Обмотка1Слой        
			тогда     
			Обмотка1Слой=Обмотка1Слой+1;              
			НовСтр.НомерОперации = Обмотка1Слой;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.Обмотка2Слоя        
			тогда      
			Обмотка2Слоя=Обмотка2Слоя+1;
			НовСтр.НомерОперации = Обмотка2Слоя;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ОбмоткаБроней        
			тогда       
			ОбмоткаБроней=ОбмоткаБроней+1;
			НовСтр.НомерОперации = ОбмоткаБроней;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ОбмоткаПроволочнойБронёй 
			тогда      
			ОбмоткаПроволочнойБронёй=ОбмоткаПроволочнойБронёй+1;
			НовСтр.НомерОперации = ОбмоткаПроволочнойБронёй;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ОбмоткаПроволочнымЭкраном	
			тогда	   
			ОбмоткаПроволочнымЭкраном=ОбмоткаПроволочнымЭкраном+1;
			НовСтр.НомерОперации = ОбмоткаПроволочнымЭкраном;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.Изоляция                
			тогда      
			Изоляция =Изоляция+1;                 
			НовСтр.НомерОперации = Изоляция; 
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.Изоляция3слоя                
			тогда      
			Изоляция3слоя =Изоляция3слоя+1;                 
			НовСтр.НомерОперации = Изоляция3слоя; 	
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ОболочкаКруглый        
			тогда      
			ОболочкаКруглый=ОболочкаКруглый+1;    
			НовСтр.НомерОперации = ОболочкаКруглый;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ОболочкаПлоский        
			тогда     
			ОболочкаПлоский=ОболочкаПлоский+1;        
			НовСтр.НомерОперации = ОболочкаПлоский;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.Заполнение             
			тогда      
			Заполнение=Заполнение+1;	  
			НовСтр.НомерОперации = Заполнение;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ЗаполнениеИОболочка	
			тогда		
			ЗаполнениеИОболочка=ЗаполнениеИОболочка+1;							
			НовСтр.НомерОперации = ЗаполнениеИОболочка; 
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ОболочкаШлангом             
			тогда      
			ОболочкаШлангом=ОболочкаШлангом+1;	  
			НовСтр.НомерОперации = ОболочкаШлангом;
		ИначеЕсли Этап.ВидОперации=Перечисления.ВидОперации.ОболочкаПлоскийШлангом             
			тогда      
			ОболочкаПлоскийШлангом=ОболочкаПлоскийШлангом+1;	  
			НовСтр.НомерОперации = ОболочкаПлоскийШлангом;
		КонецЕсли;		 	
		#КонецОбласти				
		
		//Определяем пустое время
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ЗВП_ДопОперацииНаЭтапах.ЗатратыВремениНаОперацию КАК ЗатратыВремениНаОперацию,
		|	ЗВП_ДопОперацииНаЭтапах.Ссылка КАК Ссылка,
		|	ЗВП_ДопОперацииНаЭтапах.НаименованиеОперации КАК НаименованиеОперации,
		|	ЗВП_ДопОперацииНаЭтапах.Плюсовой КАК Плюсовой
		|ИЗ
		|	Документ.ЗаказыВПроизводство.ДополнительныеОперацииНаЭтапах КАК ЗВП_ДопОперацииНаЭтапах
		|ГДЕ
		|	ЗВП_ДопОперацииНаЭтапах.НомерЭтапа = &НомерЭтапа
		|	И ЗВП_ДопОперацииНаЭтапах.НазваниеОборудования = &НазваниеОборудования
		|	И ЗВП_ДопОперацииНаЭтапах.ВидОперации = &ВидОперации
		|	И ЗВП_ДопОперацииНаЭтапах.Ссылка = &СсылкаНаЗаказ";
		
		
		
		Запрос.УстановитьПараметр("НомерЭтапа",НовСтр.НомерЭтапа);
		Запрос.УстановитьПараметр("НазваниеОборудования", 	НовСтр.НазваниеОборудования);
		Запрос.УстановитьПараметр("ВидОперации", НовСтр.ВидОперации);
		Запрос.УстановитьПараметр("СсылкаНаЗаказ", СсылкаНаЗаказ);   
		
		Если НовСтр.ПлюсовойКабель="Плюсовой" тогда
			ПлюсовойКабель=Перечис_Плюс.Плюсовой;    
			Запрос.УстановитьПараметр("НомерЭтапа",НовСтр.НомерСтроки);
		ИначеЕсли НовСтр.ПлюсовойКабель="Основной" тогда
			ПлюсовойКабель=Перечис_Плюс.Основной;
			Запрос.УстановитьПараметр("НомерЭтапа", НовСтр.НомерСтроки);
		ИначеЕсли НовСтр.ПлюсовойКабель="Суммарный" тогда
			ПлюсовойКабель=Перечис_Плюс.Суммарный;
			Запрос.УстановитьПараметр("НомерЭтапа", НовСтр.НомерСтроки);
		ИначеЕсли НовСтр.ПлюсовойКабель="р_Вспомогательный" тогда
			ПлюсовойКабель=Перечис_Плюс.Спомогательный;
			Запрос.УстановитьПараметр("НомерЭтапа", НовСтр.НомерСтроки);
		ИначеЕсли НовСтр.ПлюсовойКабель="" тогда
			ПлюсовойКабель=Перечис_Плюс.ПустаяСсылка();
		КонецЕсли;                  
		
		ВДЗ = Запрос.Выполнить().Выбрать();	  
		
		Пока ВДЗ.Следующий() Цикл
			Если ВДЗ.НаименованиеОперации.Пустая() и ВДЗ.Плюсовой=ПлюсовойКабель  
				Тогда					
				НовСтр.ЗатратыВРемениНаОперацию=ВДЗ.ЗатратыВремениНаОперацию;					
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;	
	
	
	
	
	

</details>

## &НаКлиенте Процедура ОткрытьВыбранныйЗаказ(Команда)
<details>
    <summary> 
 Код  </summary>


	ТекДанные= новый структура;            
	ТекДанные.Вставить("Оборудование",ТекущийЭлемент.ТекущиеДанные.НазваниеОборудования);
	ТекДанные.Вставить("Материал1",ТекущийЭлемент.ТекущиеДанные.Материал1);
	ТекДанные.Вставить("НомерСчета",НомерСчета);
	ТекДанные.Вставить("ВидОперации",ТекущийЭлемент.ТекущиеДанные.ВидОперации);
	ТекДанные.Вставить("НомерСтроки", ТекущийЭлемент.ТекущиеДанные.НомерСтроки);
	
	
	
	
	
	
	ФормаПараметр = Новый Структура("Ключ",СсылкаНаЗаказ);
	Форма = ПолучитьФорму("Документ.ЗаказыВПроизводство.Форма.ФормаДокумента", ФормаПараметр).ОткрытьМодально();

</details>

## &НаСервере Процедура ПерезаписатьНаСервере(ТД)

 <details>
   <summary>
 Код  </summary>


	////////Перезапись/////////
	Счетчик=0;
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ЗВП_Этапы.ВидОперации КАК ВидОперации,
	|	ЗВП_Этапы.Ссылка.НомерСчета КАК НомерСчета,
	|	ЗВП_Этапы.НазваниеОборудования КАК Оборудование,
	|	ЗВП_Этапы.НомерЭтапа КАК НомерЭтапа,
	|	ЗВП_Этапы.ВремяВыполненияЗаказаМинут КАК ВремяВыполненияЗаказаМинут,
	|	ЗВП_Этапы.Ссылка КАК Ссылка
	|ИЗ
	|	Документ.ЗаказыВПроизводство.ЭтапыИОборудование КАК ЗВП_Этапы
	|ГДЕ
	|	ЗВП_Этапы.Ссылка = &СсылкаНаЗаказ
	|	И ЗВП_Этапы.ВидОперации = &ВидОперации";
	
	Запрос.УстановитьПараметр("СсылкаНаЗаказ", СсылкаНаЗаказ);
	Запрос.УстановитьПараметр("ВидОперации", ТД.ВидОперации);
	РезультатЗапроса = Запрос.Выполнить();  
	ВДЗ = РезультатЗапроса.Выбрать();
	Пока ВДЗ.Следующий() Цикл
		Док=ВДЗ.Ссылка.ПолучитьОбъект(); 
		Для каждого Строка Из Док.ЭтапыИОборудование Цикл    
			Если Строка.ВидОперации=ТД.ВидОперации тогда
				Счетчик=Счетчик+1;
				Если Счетчик=ТД.НомерОперации тогда   
					ЗаполнитьЗначенияСвойств(Строка,ТД);
					Строка.НазваниеОборудования= 	Справочники.НоменклатураОборудований.НайтиПоНаименованию(ТД.Оборудование);
					//////Строка.Материал1= 		        ТД.Материал1;		
					//////Строка.Материал2= 		        ТД.Материал2;		
					//////Строка.Материал3= 		        ТД.Материал3;		
					//////Строка.Материал4= 		        ТД.Материал4;		
					//////Строка.Материал5= 		        ТД.Материал5;		
					Док.ДиаметрПроволоки=			Строка(ТД.ДиаметрПроволоки);
				КонецЕсли;
			КонецЕсли;
		КонецЦикла; 
		Док.н_ПринудительныйПересчет=Истина;
		Док.Записать();
	КонецЦикла;

</details>

## &НаКлиенте Процедура Перезаписать (Команда)                        
 <details>
    <summary> 
 Код  </summary>


	ТД = ТекущийЭлемент.ТекущиеДанные;
	ТекДанные= новый структура;           	
	ТекДанные.Вставить("НомерОперации", ТД.НомерОперации);
	ТекДанные.Вставить("Оборудование",	ТД.НазваниеОборудования);
	ТекДанные.Вставить("Материал1",		ТД.Материал1);
	ТекДанные.Вставить("Материал2",		ТД.Материал2);
	ТекДанные.Вставить("Материал3",		ТД.Материал3);
	ТекДанные.Вставить("Материал4",		ТД.Материал4);
	ТекДанные.Вставить("Материал5",		ТД.Материал5);
	ТекДанные.Вставить("ДиаметрПроволоки",	ТД.ДиаметрПроволоки);
	ТекДанные.Вставить("ВидОперации",		ТД.ВидОперации);
	
	ПерезаписатьНаСервере(ТекДанные); 
	ТаблЧасть.Очистить();       	
	ПриСозданииНаСервере(Ложь,Истина);

</details>

## &НаКлиенте Процедура ТаблЧастьВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
<details>
    <summary> 
 Код  </summary>


	Если Элементы.ТаблЧастьРежимИзменения.Пометка тогда
	Иначе
		ТД=ТекущийЭлемент.ТекущиеДанные;
		Результат = Новый Структура;                                                          
		Результат.Вставить("Оборудование", 					ТД.НазваниеОборудования); 
		Результат.Вставить("ВидОперации", 					ТД.ВидОперации); 
		Результат.Вставить("НомерЭтапа", 					ТД.НомерЭтапа);                 
		Результат.Вставить("НомерОперации", 				ТД.НомерОперации);
		Результат.Вставить("ЗатратыВремениНаОперацию", 		ТД.ЗатратыВремениНаОперацию);
		Результат.Вставить("ВремяВыполненияЗаказаМинут", 	ТД.ВремяВыполненияЗаказаМинут);
		Результат.Вставить("РасчетноеВремяЗапуска", 		ТД.РасчетноеВремяЗапуска);
		Результат.Вставить("РасчетноеВремяОкончанияЭтапа", 	ТД.РасчетноеВремяОкончанияЭтапа);
		Результат.Вставить("Материал1", 					ТД.Материал1);
		Результат.Вставить("Материал2", 					ТД.Материал2);
		Результат.Вставить("Материал3", 					ТД.Материал3);
		Результат.Вставить("Материал4", 					ТД.Материал4);
		Результат.Вставить("Материал5", 					ТД.Материал5);   
		Результат.Вставить("ВыбранныйБарабан", 				ТД.ВыбранныйБарабан);
		Результат.Вставить("IDZak", ЭтаФорма.IDZak);   
		Результат.Вставить("Сечение",ТД.Сечение);
		//+06.03.2023 Яковлев А.
		Если 	Строка(ТД.НазваниеОборудования) = "Экструзионная линия № 001 ХМ 90/25" 
			или Строка(ТД.НазваниеОборудования) = "Экструзионная линия № 009 ХМ 70/25" Тогда
			//70 или 90 пресс, расчеты производятся в отдельной форме
			Результат.Вставить("НомерСчета",ЭтотОбъект.НомерСчета);
			Результат.Вставить("ПлюсовойКабель",ТД.ПлюсовойКабель);   
			Результат.Вставить("Фио",ЭтаФорма.Фио);
			Результат.Вставить("НомерОперации",ТД.НомерОперации);         
			Результат.Вставить("ГрупповойРезерв",ЭтаФорма.ГрупповойРезерв); 
			Результат.Вставить("СсылкаНаЗаказ",ЭтаФорма.СсылкаНаЗаказ); 
			
			Форма = ПолучитьФорму("Документ.Выработка.Форма.Пресс70или90", Результат);    	
			РезФормы=Форма.ОткрытьМодально();	
			Если не РезФормы=неопределено тогда
				Если РезФормы.Свойство("ОбщееКолвоКМ") тогда
					Результат.Вставить("ОбщееКолвоКМ",							РезФормы.ОбщееКолвоКМ);
					Результат.Вставить("Цена",									РезФормы.Цена); 
					Результат.Вставить("Разряд",								РезФормы.Разряд);
					Результат.Вставить("КоэфСмены",								РезФормы.КоэфСмены);
					Результат.Вставить("РасценкаЗаСменуПластиката",				РезФормы.РасценкаЗаСменуПластиката);
					
					Результат.Вставить("ГрупповойРезерв",						РезФормы.ГрупповойРезерв);         
					Результат.Вставить("РасценкаЗаСменуЦвета",					РезФормы.РасценкаЗаСменуЦвета);         
					Результат.Вставить("РасценкаЗаСменуИнструмента",			РезФормы.РасценкаЗаСменуИнструмента);         
					Результат.Вставить("КоэффициентЗагруженностиОборудования",	РезФормы.КоэфЗагрОб);
				КонецЕсли;   
			иначе
				Результат=Неопределено;
			КонецЕсли;
		КонецЕсли;
		
		Закрыть(Результат);   
		
	КонецЕсли;
	

</details>

## &НаКлиенте Процедура РежимИзменения(Команда)   
<details>
    <summary> 
 Код  </summary>


	Элементы.ТаблЧастьРежимИзменения.Пометка = не Элементы.ТаблЧастьРежимИзменения.Пометка;
	Элементы.ПерезаписатьПараметрыВЗаказ.Видимость = Элементы.ТаблЧастьРежимИзменения.Пометка;  
	Если Элементы.ТаблЧастьРежимИзменения.Пометка тогда 
		Элементы.ТаблЧастьРежимИзменения.Заголовок = "Выключить режим изменения заказа";
	Иначе                                           
		Элементы.ТаблЧастьРежимИзменения.Заголовок = "Включить режим изменения заказа";
	КонецЕсли;

</details>
