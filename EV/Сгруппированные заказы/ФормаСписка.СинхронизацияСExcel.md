# Синхронизация с Excel
## Процедура на клиенте СинхронизацияСExcel(Команда)
Формируем массив заказов из эксель с дальнейшей его отправкой на формуИсправления
Открываем формуИсправления для работы непосредственно с синхронизацией Excel-задания с 1С...
```
СтруктураПараметров = Новый Структура;
Массив = ПолучитьСтруктуруПараметров();  
СтруктураПараметров.Вставить("МассивИзЭксель",Массив); 
ОткрытьФорму("Документ.СгруппированныеЗаказы.Форма.ФормаИсправления",СтруктураПараметров);
```
[Форма исправления](https://github.com/AB-TREYD/1C/blob/Shtirlits/EV/Сгруппированные%20заказы/ФормаИсправления.md#формаисправления)

## ПолучитьСтруктуруПараметров()

 Обращаемся к файлу Excel и берем все доступные записи   
 Путь прописываем в поле ИмяФайлаЗадания, формат такого плана:   
 "C:\Users\a.yakovlev\Задание НОЯБРЬ 2023г"  Далее формируется массив эз элементов листа Excel  
 0 - Номер счета  
 1 - Название оборудования 1С  
 Обход элементов Excel завершается по достижении строчки с надписью "конец"
<details>
  <summary>Код</summary>

	МассивРезультатов = новый Массив(2,15000);
	ИндексМассиваРезультатов = 0;
	МассивОборудований = Новый Массив(50);
	МассивОборудований[0] = "Линия изоляции ХМ 90/25";
	МассивОборудований[1] = "Линия изоляции ХМ 70/25";
	МассивОборудований[2] = "Линия изоляции ХМ 120/25 (изоляция) старый пресс";
	МассивОборудований[3] = "Линия  ХМ 120/25 +  90/25  Тандем_1";
	МассивОборудований[4] = "Линия  ХМ 120/25 + ХМ 120/25  Тандем_2";
	МассивОборудований[5] = "Линия изоляции ХМ 150/25";
	МассивОборудований[6] = "НОВАЯ ЖР";
	МассивОборудований[7] = "СТАРАЯ ЖР";
	МассивОборудований[8] = "БУГЕЛЬ 1000";
	МассивОборудований[9] = "БУГЕЛЬ 1600";
	МассивОборудований[10] = "Драмтвистер";
	МассивОборудований[11] = "Сигара";
	МассивОборудований[12] = "Двойная скрутка";
	МассивОборудований[13] = "Скрутка стренги";
	МассивОборудований[14] = "Лентообмотка вертикальная ";
	МассивОборудований[15] = "Лентообмотка горизонтальная";
	МассивОборудований[16] = "Бронеобмотчик";
	МассивОборудований[17] = "Волочилка";
	МассивОборудований[18] = "НОВАЯ ВОЛОЧИЛКА";
	МассивОборудований[19] = "Мультиваер  ВОЛОЧИЛКА";
	МассивОборудований[20] = "Алюминиевая волочилка";
	МассивОборудований[21] = "Линия изоляции ХМ 120/25 (изоляция) новый пресс";
	МассивОборудований[22] = "Линия winlong  3х120 - 3 тандем";
	МассивОборудований[23] = "НОВАЯ Двойная скрутка";
	МассивОборудований[24] = "НОВЫЙ Бронеобмотчик";	
	Если ИмяФайлаЗадания ="" Тогда
		Сообщить("Ведите имя файла!");		
	Иначе
	КонецЕсли;	
	ПутьКФайлу = ИмяФайлаЗадания + ".xlsx";
	Ex = Новый COMObject("Excel.Application");
	Ex.Workbooks.Open(ПутьКФайлу);
	Ex.Visible = 1;    
	Ex.Range("A2").Select();
	ИндексируемаяСтрока = 2;
	РабочаяЯчейка = Ex.Cells(ИндексируемаяСтрока, 1).Value; 
	ТекОборуд = Ложь;
	Пока РабочаяЯчейка <> "конец" цикл
		Если ТекОборуд = Ложь Тогда
			Для циклПеребораОборудований = 1 по 25 цикл
				Если РабочаяЯчейка = МассивОборудований[циклПеребораОборудований-1] Тогда
					ТекОборуд = Истина;
					ИндексМассиваТекОборудования = циклПеребораОборудований-1;
					Прервать;
				КонецЕсли;				
			КонецЦикла;
		Иначе
			Для циклПеребораОборудований = 1 по 25 цикл
				НашлиВСписке = Ложь;
				Если РабочаяЯчейка = МассивОборудований[циклПеребораОборудований-1] Тогда
					НашлиВСписке = Истина;
					ИндексМассиваТекОборудования = циклПеребораОборудований-1;
					Прервать;
				КонецЕсли;	
			КонецЦикла;
			Если НашлиВСписке = Истина Тогда
			Иначе
				Если (СтрНайти(РабочаяЯчейка,"к-") > 0 или СтрНайти(РабочаяЯчейка,"К-") > 0 или СтрНайти(РабочаяЯчейка,"ТП1-") > 0 или СтрНайти(РабочаяЯчейка,"ТД1-") > 0 или СтрНайти(РабочаяЯчейка,"001-") > 0) и не (СтрНайти(РабочаяЯчейка,"ХМК-") > 0 или СтрНайти(РабочаяЯчейка,"брак-карта") > 0) Тогда
					РабочаяЯчейка = ПроверкаНомераСчёта(РабочаяЯчейка);
					МассивРезультатов[0][ИндексМассиваРезультатов] = РабочаяЯчейка;  
					МассивРезультатов[1][ИндексМассиваРезультатов] = МассивОборудований[ИндексМассиваТекОборудования]; 
					ИндексМассиваРезультатов = ИндексМассиваРезультатов + 1;										
				Иначе				
				КонецЕсли;
			КонецЕсли;			
		КонецЕсли;
		ИндексируемаяСтрока = ИндексируемаяСтрока + 1;
		РабочаяЯчейка = Ex.Cells(ИндексируемаяСтрока, 1).Value;
		Ex.Cells(ИндексируемаяСтрока, 1).Select();		
	КонецЦикла;	
 	Ex.DisplayAlerts = 0;
	Ex.Workbooks.Close();
	Ex.DisplayAlerts = 1;
	Ex.Quit();  	
	Возврат МассивРезультатов; 
</details>
  
