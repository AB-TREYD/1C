## Процедура СозданиеДокумента(Структ) Экспорт 
<details>
  <summary>
    Код
  </summary>
  
        Перем видИсполнения; 
        	//создали документ
        	НовыйДокумент = Документы.ЗаказыВПроизводство.СоздатьДокумент(); 
        	//IDZak
        	НовыйДокумент.IDZak = ФормированиеIDZak("");  
        	Структ.вставить("idzak",НовыйДокумент.IDZak);
        	Если Структ.Свойство("Заказ") тогда
        		НовыйДокумент.НоменклатураERP = Структ.Заказ;
        	КонецЕсли;  
        	НовыйДокумент.Толеранс=Структ.Толеранс; 
        	IDZak = НовыйДокумент.IDZak;   
        	//
        	НовыйДокумент.КоэффициентСпецификации = 1; //30.11.2023
        	//данные номенклатуры ерп
        	НовыйДокумент.Артикул = "000100131"; //? 
        	НовыйДокумент.н_ИспользоватьНовуюКодировкуМатериала=Истина;  //используем новую кодировку
        	НовыйДокумент.ДобавленИзЕРП = 						Структ.ДобавленИзЕРП;
        	НовыйДокумент.КомментарийИзERP = 					Структ.Комментарий;
        	НовыйДокумент.Дата = ТекущаяДата();     
        	ДатаВыходаПоЗаказу = ?(Структ.ДатаВыходаПоЗаказу = Null,ТекущаяДата(),Структ.ДатаВыходаПоЗаказу);                          
        	НовыйДокумент.ДатаВыпускаПоЗаказу = 				ДатаВыходаПоЗаказу;
        	НовыйДокумент.ДатаПриоритета = 						ДатаВыходаПоЗаказу;
        	НовыйДокумент.КоличествоКилометровПоЗаказу = 		Структ.КоличествоКилометровПоЗаказу;	
        	НовыйДокумент.КоличествоКилометровВПроизводство = 	Структ.КоличествоКилометровПоЗаказу;
        	НовыйДокумент.НомерСчета = ?(Структ.НомерСчёта = "","Тест",Структ.НомерСчёта);                          
        	НовыйДокумент.КоэффициентКонвертации=				Структ.КоэффициентКонвертации; 	
        	НовыйДокумент.Тип = 								Структ.Тип; //провод, силовой, кабель и тому подобные    
        	НовыйДокумент.МаркаЗаказа = 						Структ.Марка; 
        	НовыйДокумент.Расширение = 							Структ.РасширениеМарки;  
        	НовыйДокумент.ПлюсовойКабель = 						Структ.ПлюсовойКабель;
        	НовыйДокумент.ВариантИсполнения= 					Структ.ВариантИсполнения; 
        	НовыйДокумент.ПроцентСкидки = 						структ.ПроцентСкидки;
        	НовыйДокумент.СтатусЗаказа =                        Перечисления.СтатусыПроизводства.Вграфике;
        	НовыйДокумент.КомментНеСтандарт =                   Структ.КомментНеСтандарт;   
        	НовыйДокумент.НеСтандарт =                          Структ.БулевоНеСтандарт;
        	Если СтрНайти(нрег(НовыйДокумент.НомерСчета),"бз") тогда
        		НовыйДокумент.СтатусЗаказа =                    Перечисления.СтатусыПроизводства.НаИспытании;
        	КонецЕсли;
        	Если ПроверкаНаМонашоваНеСтандарт(НовыйДокумент.НоменклатураERP) Тогда  
        		НовыйДокумент.ВариантИсполнения = Справочники.ВидИсполнения.НайтиПоНаименованию("Монашов");
          		НовыйДокумент.НеСтандарт = Ложь;
        	КонецЕсли;            
        	
        	НамоткаПримечание =?(структ.Примечание="",Структ.Намотка,Структ.Примечание+";"+Структ.Намотка);
        	
        	Если Структ.ЕдиницаИзмеренияЗаказа=Перечисления.ЕдиницаИзмеренияЗаказа.ПустаяСсылка() тогда
        		Структ.ЕдиницаИзмеренияЗаказа=Перечисления.ЕдиницаИзмеренияЗаказа.Км;			
        	КонецЕсли;	 
        	Ltx = ЕстьLTX(НовыйДокумент.МаркаЗаказа + НовыйДокумент.Расширение);   //плюсовой 
        	Структ.Вставить("Ltx",Ltx);          
        	
        	Если Структ.Свойство("СечениеЭкрана") тогда			
        		СечениеЭкранаИЛенты = Справочники.СправочникСечений.НайтиПоНаименованию(Структ.СечениеЭкрана); //было СечениеЭкранаИЛенты=СечениеЭкранаИЛенты; Структ передает значение СечениеЭкранаИЛенты, а значение передаваемое в функцию всегда равно пустой строке
        		Если СечениеЭкранаИЛенты = Справочники.СправочникСечений.ПустаяСсылка() или СечениеЭкранаИЛенты = Справочники.СправочникСечений.Найтипокоду("000000028") тогда
        			СечениеЭкранаИЛенты = Справочники.СправочникСечений.НайтиПоКоду("000000025");
        		КонецЕсли;	
        	Иначе  
        		СечениеЭкранаИЛенты = Справочники.СправочникСечений.НайтиПоКоду("000000025");
        	КонецЕсли;	 
        	Если Лев(НовыйДокумент.МаркаЗаказа,1) = "А"  или СтрНайти(НовыйДокумент.МаркаЗаказа,"СИП")>0 Тогда //Нужен для определения конструкции!
        		ИспользуемыйМеталл = Справочники.НоменклатураМатериалов.НайтиПоКоду("000000007");//алюм	
        	Иначе
        		ИспользуемыйМеталл = Справочники.НоменклатураМатериалов.НайтиПоКоду("000000024");	//медь	
        	КонецЕсли; 	
        	Структ.Вставить("ИспользуемыйМеталл",ИспользуемыйМеталл);
        	НовыйДокумент.ПримечаниеИНамоткаИзERP=				НамоткаПримечание;
        	НовыйДокумент.ЕдиницаИзмеренияЗаказа=				структ.ЕдиницаИзмеренияЗаказа;	
        	НовыйДокумент.СечениеЭкранаИЛенты = 				СечениеЭкранаИЛенты;	
        	
        	ПроверкаСправочников(структ); //++
        	Если структ.плюсовойКабель тогда
        		НовыйДокумент.КоличествоЖилПлюсовой = 	Справочники.СправочникКоличествоЖил.НайтиПоНаименованию(Структ.КоличествоЖилПлюсовой);
        		НовыйДокумент.СечениеПлюсовой 		=	Справочники.СправочникСечений.НайтиПоНаименованию(Структ.СечениеПлюсовой);
        		Если НовыйДокумент.СечениеПлюсовой 	= 	Справочники.СправочникСечений.ПустаяСсылка() тогда
        			НовыйДокумент.СечениеПлюсовой 	=	Справочники.СправочникСечений.НайтиПоНаименованию(СтрЗаменить(Структ.СечениеПлюсовой,",0",""));
        		КонецЕсли;
        		НовыйДокумент.ИсполнениеЖилыПлюсовой = 	Справочники.ИсполнениеЖилы.НайтиПоНаименованию(Структ.ИсполнениеЖилыПлюсовой);
        	КонецЕсли;
        	НовыйДокумент.Напряжение = 		Справочники.СправочникНапряжений.НайтиПоНаименованию(Структ.Напряжение);	
        	НовыйДокумент.ИсполнениеЖилы = 	Справочники.ИсполнениеЖилы.НайтиПоНаименованию(Структ.ИсполнениеЖилы);
        	НовыйДокумент.NPE = 			Справочники.СправочникNPE.НайтиПоНаименованию(Структ.NPE);
        	НовыйДокумент.КоличествоЖил = 	Справочники.СправочникКоличествоЖил.НайтиПоНаименованию(Структ.КоличествоЖил);
        	НовыйДокумент.Сечение = 		Справочники.СправочникСечений.НайтиПоНаименованию(Строка(число(Структ.Сечение)));//для исключения ошибок типа сечение = "4,0" 
        	
        	//Данилова 01.08.2023 Для загрузки сечения=1000     //РЕФАКТОРИНГ!!!!!!!!!!!!!!!!!!!!ЭТО КОСТЫЛЬ!!!!!!!!!
        	Если Структ.Сечение="1000" тогда
        		  НовыйДокумент.Сечение =   Справочники.СправочникСечений.НайтиПоНаименованию("1000");
        	КонецЕсли;
        	//-Данилова	
        	
        	Если НовыйДокумент.Тип = Перечисления.ТипПродукции.Отходы тогда //отходы
        		НовыйДокумент.МаркаЗаказаИзЕРП = "Отходы";
        		НовыйДокумент.МаркаЗаказа	   = НовыйДокумент.НоменклатураERP;   
        		НовыйДокумент.н_ПровереноПлановымОтделом = истина;
        		НовыйДокумент.СтатусЗаказа 	   = Перечисления.СтатусыПроизводства.Изготовлен;
         	КонецЕсли;
        	
        	Если строка(новыйДокумент.Напряжение)="" 
        		или строка(новыйДокумент.ИсполнениеЖилы)="" 
        		или строка(новыйДокумент.NPE)="" 
        		или строка(новыйДокумент.КоличествоЖил)="" или строка(новыйДокумент.КоличествоЖил)="0"  	
        		или строка(новыйДокумент.Сечение)="" или строка(новыйДокумент.Сечение)="0"
        		тогда  
        		Структ.Вставить("НеХватаетОсновныхПараметров",Истина);
        	Иначе 
        		Если строка(новыйДокумент.ВариантИсполнения)="" тогда    
        			НеХватаетВариантаИсполнения=Истина;                 
        		Иначе                                                  
        			НеХватаетВариантаИсполнения=Ложь;                   
        		КонецЕсли;                                              
        		Структ.Вставить("НеХватаетОсновныхПараметров",Ложь);
        	КонецЕсли;
        	Если Структ.ПлюсовойКабель тогда		
        		Если строка(новыйДокумент.КоличествоЖилПлюсовой)="" или строка(новыйДокумент.КоличествоЖилПлюсовой)="0"  	
        			или строка(новыйДокумент.СечениеПлюсовой)="" или строка(новыйДокумент.СечениеПлюсовой)="0"  
        			или строка(новыйДокумент.ИсполнениеЖилыПлюсовой)="" 
        			тогда
        			Структ.Вставить("НеХватаетОсновныхПараметров",Истина);   
        		КонецЕсли;   
        	КонецЕсли;
        	//марка                          
        	НовыйДокумент.МаркаЗаказа=?(Структ.LTX=истина,ЕслиLTXистина(структ),НовыйДокумент.МаркаЗаказа);
        	Структ.Марка=НовыйДокумент.МаркаЗаказа;
        	//
        	
        	Структ.Вставить("Гибкий",ЭтоГибкий(НовыйДокумент.НоменклатураERP));  
        	НовыйДокумент.Гибкий = Структ.Гибкий; 
        	Структ.Вставить("FR",ЕстьFR(Структ.Марка));
        	
        	Если не Структ.НеХватаетОсновныхПараметров тогда  
        		//Параметры Кабеля
        		ПараметрыКабеля=ПолучитьПараметрыКабеля(Структ);
        		
        		Если НовыйДокумент.ВариантИсполнения.Наименование = "Монашов" Тогда
        			ПараметрыКабеля.Вставить("ВариантИсполнения",Справочники.ВидИсполнения.НайтиПоНаименованию("Монашов"));
        		Иначе
        			ПараметрыКабеля.Вставить("ВариантИсполнения",Справочники.ВидИсполнения.НайтиПоНаименованию("Эталон"));
        		КонецЕсли; 
        		
        		ПараметрыКабеля.Вставить("НоменклатураERP",НовыйДокумент.НоменклатураERP); 
        		
        		НовыйДокумент.РазновидностьКабеля = ПоискРазновидностиКабеля(ПараметрыКабеля,ложь);     
        		Если Структ.ПлюсовойКабель тогда 
        			НовыйДокумент.РазновидностьКабеляПлюсовой = ПоискРазновидностиКабеля(ПараметрыКабеля,истина);
        		КонецЕсли;
        		
        		ПроцентСкидки = ?(Структ.ПроцентСкидки = "",0,Структ.ПроцентСкидки);
        		Если НовыйДокумент.РазновидностьКабеля = 2 или число(ПроцентСкидки)<0 Тогда         
        			ПараметрыКабеля.ПроцентСкидкиОт = 0;
        			ПараметрыКабеля.ПроцентСкидкиДо = 0;
        			ПараметрыКабеля.ПроцентСкидки = 0;    
        		Иначе
        			ПараметрыКабеля.ПроцентСкидки = Число(Окр(ПроцентСкидки)); 
        			ПараметрыКабеля.ПроцентСкидкиОт = Число(Окр(ПроцентСкидки));
        			ПараметрыКабеля.ПроцентСкидкиДо = Число(Окр(ПроцентСкидки));
        		КонецЕсли;
        		//
        		#Область Конструкция 
        		//Обнуляем т.к. до этого он уже предзаполнен!   (из-за поиска разновидности кабеля)	
        		ПараметрыКабеля=ОчиститьКонструкциюПараметровКабеля(ПараметрыКабеля,Ложь);	
        		//Эталон    					                                                   
        		
        		Если НовыйДокумент.ВариантИсполнения.Наименование = "Монашов" Тогда
        			ПараметрыКабеля.Вставить("ВариантИсполнения",Справочники.ВидИсполнения.НайтиПоНаименованию("Монашов"));
        		Иначе
        			ПараметрыКабеля.Вставить("ВариантИсполнения",Справочники.ВидИсполнения.НайтиПоНаименованию("Эталон"));
        		КонецЕсли;
        		
        		ПараметрыКабеля = ПоискКонструкцииИДиаметраКабеля(ПараметрыКабеля,Ложь);	
        		НовыйДокумент.н_ДиаметрПроволокиЭталон = 						СтрЗаменить(ПараметрыКабеля.ДиаметрПроволоки,".",","); 							
        		НовыйДокумент.н_ДиаметрПроволокиДляПотребностиВМеталлеЭталон = 	СтрЗаменить(ПараметрыКабеля.ДиаметрПроволкиДляРасчётаПотребностиМеталла,".",","); 
        		НовыйДокумент.н_КоличествоЗарядныхКатушекНаСтренгеЭталон = 		ПараметрыКабеля.КоличествоЗарядныхКатушекНаСтренге;
        		НовыйДокумент.н_КоличествоПроволокНаОднойКатушкеЭталон = 		ПараметрыКабеля.КоличествоПроволокНаОднойКатушке;
        		НовыйДокумент.н_КоличествоПроволокВЖилеЭталон =  				ПараметрыКабеля.КоличествоПроволокВЖиле;          
        		//+Данилова 01.08.2023
        		НовыйДокумент.н_КоличествоЗарядныхКатушекНаСтренгеЭталонДоп = 		ПараметрыКабеля.КоличествоЗарядныхКатушекНаСтренгеДоп;
        		НовыйДокумент.н_КоличествоПроволокНаОднойКатушкеЭталонДоп = 		ПараметрыКабеля.КоличествоПроволокНаОднойКатушкеДоп;
        		//-Данилова
        		НовыйДокумент.ДиаметрТПЖЭталон = 								ПараметрыКабеля.ДиаметрТПЖ;   
        		НовыйДокумент.ФактическоеСечениеЭталон = 						ПараметрыКабеля.ФактическоеСечение;
        		НовыйДокумент.ЭквивалентныйДиаметрЭталон =						ПараметрыКабеля.ЭквивалентныйДиаметр;		
        		НовыйДокумент.ДиаметрЦентральногоЖгутаЭталон =                  ПараметрыКабеля.ДиаметрЦентральногоЖгута;   
        		НовыйДокумент.ВысотаСегментаЭталон =                            ПараметрыКабеля.ВысотаСегмента;		        
        		
        		ПараметрыКабеля=ОчиститьКонструкциюПараметровКабеля(ПараметрыКабеля,Ложь);	
        		
        		Если Структ.ПлюсовойКабель тогда
        			//ПлюсовойЭталон
        			ПараметрыКабеля = ПоискКонструкцииИДиаметраКабеля(ПараметрыКабеля,Истина);
        			НовыйДокумент.н_ДиаметрПроволокиПлюсовойЭталон = 						СтрЗаменить(ПараметрыКабеля.ДиаметрПроволокиПлюсовой,".",","); 										
        			НовыйДокумент.н_ДиаметрПроволокиДляПотребностиВМеталлеПлюсовойЭталон = 	СтрЗаменить(ПараметрыКабеля.ДиаметрПроволкиДляРасчётаПотребностиМеталлаПлюсовой,".",",");
        			НовыйДокумент.н_КоличествоЗарядныхКатушекНаСтренгеПлюсовойЭталон =  	ПараметрыКабеля.КоличествоЗарядныхКатушекНаСтренгеПлюсовой;  
        			НовыйДокумент.н_КоличествоПроволокНаОднойКатушкеПлюсовойЭталон =		ПараметрыКабеля.КоличествоПроволокНаОднойКатушкеПлюсовой;   
        			//+Данилова 01.08.2023
        			НовыйДокумент.н_КоличествоЗарядныхКатушекНаСтренгеПлюсовойЭталонДоп =  	ПараметрыКабеля.КоличествоЗарядныхКатушекНаСтренгеПлюсовойДоп;  
        			НовыйДокумент.н_КоличествоПроволокНаОднойКатушкеПлюсовойЭталонДоп =		ПараметрыКабеля.КоличествоПроволокНаОднойКатушкеПлюсовойДоп;   
        			//-Данилова
        			НовыйДокумент.н_КоличествоПроволокВЖилеПлюсовойЭталон =  				ПараметрыКабеля.КоличествоПроволокВЖилеПлюсовой;    
        			НовыйДокумент.ДиаметрТПЖПлюсовойЭталон = 								ПараметрыКабеля.ДиаметрТПЖПлюсовой;                              	
        			НовыйДокумент.ФактическоеСечениеПлюсовойЭталон = 						ПараметрыКабеля.ФактическоеСечениеПлюсовой;
        			
        			НовыйДокумент.ВысотаСегментаПлюсовойЭталон = 							0; 		//Ставцев 12.10.23
        			НовыйДокумент.ЭквивалентныйДиаметрПлюсовойЭталон = 						ПараметрыКабеля.ЭквивалентныйДиаметр;	//Ставцев 12.10.23
        			ПараметрыКабеля=ОчиститьКонструкциюПараметровКабеля(ПараметрыКабеля,Истина)	
        			
        		КонецЕсли;  	       
        		Если НеХватаетВариантаИсполнения=ложь тогда // если нет варианта исполнения не означает что конструкция не должна найтись по эталону!
        			//факт						
        			ПараметрыКабеля.Вставить("ВариантИсполнения",Структ.ВариантИсполнения);  
        			ПараметрыКабеля = ПоискКонструкцииИДиаметраКабеля(ПараметрыКабеля,Ложь);
        			НовыйДокумент.ДиаметрПроволоки = 						СтрЗаменить(ПараметрыКабеля.ДиаметрПроволоки,".",",");	          
        			НовыйДокумент.ДиаметрПроволокиДляПотребностиВМеталле = 	СтрЗаменить(ПараметрыКабеля.ДиаметрПроволкиДляРасчётаПотребностиМеталла,".",",");		
        			НовыйДокумент.КоличествоЗарядныхКатушекНаСтренге =  	ПараметрыКабеля.КоличествоЗарядныхКатушекНаСтренге;
        			НовыйДокумент.КоличествоПроволокНаОднойКатушке = 		ПараметрыКабеля.КоличествоПроволокНаОднойКатушке;
        			//+Данилова 01.08.2023
                    НовыйДокумент.КоличествоЗарядныхКатушекНаСтренгеДоп =  	ПараметрыКабеля.КоличествоЗарядныхКатушекНаСтренгеДоп;
        			НовыйДокумент.КоличествоПроволокНаОднойКатушкеДоп = 		ПараметрыКабеля.КоличествоПроволокНаОднойКатушкеДоп; 
        			//-Данилова
        			НовыйДокумент.КоличествоПроволокВЖиле =  				ПараметрыКабеля.КоличествоПроволокВЖиле;
        			НовыйДокумент.ДиаметрТПЖ = 								ПараметрыКабеля.ДиаметрТПЖ;
        			НовыйДокумент.ФактическоеСечение = 						ПараметрыКабеля.ФактическоеСечение;
        			НовыйДокумент.ЭквивалентныйДиаметр =						ПараметрыКабеля.ЭквивалентныйДиаметр;		
        			НовыйДокумент.ДиаметрЦентральногоЖгута =                  ПараметрыКабеля.ДиаметрЦентральногоЖгута;   
        			НовыйДокумент.ВысотаСегмента =                            ПараметрыКабеля.ВысотаСегмента;		        
        			Если Структ.ПлюсовойКабель тогда		
        				//Плюсовой факт
        				ПараметрыКабеля = ПоискКонструкцииИДиаметраКабеля(ПараметрыКабеля,Истина);			
        				НовыйДокумент.ДиаметрПроволокиПлюсовой= 						СтрЗаменить(ПараметрыКабеля.ДиаметрПроволокиПлюсовой,".",",");  	
        				НовыйДокумент.ДиаметрПроволокиДляПотребностиВМеталлеПлюсовой = 	СтрЗаменить(ПараметрыКабеля.ДиаметрПроволкиДляРасчётаПотребностиМеталлаПлюсовой,".",",");
        				НовыйДокумент.КоличествоЗарядныхКатушекНаСтренгеПлюсовой =  	ПараметрыКабеля.КоличествоЗарядныхКатушекНаСтренгеПлюсовой;
        				НовыйДокумент.КоличествоПроволокНаОднойКатушкеПлюсовой = 		ПараметрыКабеля.КоличествоПроволокНаОднойКатушкеПлюсовой;
        				//+Данилова 01.08.2023 
        				НовыйДокумент.КоличествоЗарядныхКатушекНаСтренгеПлюсовойДоп =  	ПараметрыКабеля.КоличествоЗарядныхКатушекНаСтренгеПлюсовойДоп;
        				НовыйДокумент.КоличествоПроволокНаОднойКатушкеПлюсовойДоп = 	ПараметрыКабеля.КоличествоПроволокНаОднойКатушкеПлюсовойДоп;
        				//-Данилова
        				НовыйДокумент.КоличествоПроволокВЖилеПлюсовой =  				ПараметрыКабеля.КоличествоПроволокВЖилеПлюсовой;
        				НовыйДокумент.ДиаметрТПЖПлюсовой = 								ПараметрыКабеля.ДиаметрТПЖПлюсовой;
        				НовыйДокумент.ФактическоеСечениеПлюсовой = 						ПараметрыКабеля.ФактическоеСечениеПлюсовой;
        				
        				НовыйДокумент.ВысотаСегментаПлюсовой = 							0;          //Ставцев 12.10.23
        				НовыйДокумент.ЭквивалентныйДиаметрПлюсовой = 					0;    //Ставцев 12.10.23
        
        			КонецЕсли;  	  
        			//3-4 поток ставим ноль в волоку! 16,03,23
        			Если НовыйДокумент.РазновидностьКабеля = 3 или НовыйДокумент.РазновидностьКабеля = 4 тогда
        				НовыйДокумент.ДиаметрПроволокиДляПотребностиВМеталлеПлюсовой = 	0;
        				НовыйДокумент.ДиаметрПроволокиДляПотребностиВМеталле = 	0;
        				НовыйДокумент.н_ДиаметрПроволокиДляПотребностиВМеталлеПлюсовойЭталон = 0;
        				НовыйДокумент.н_ДиаметрПроволокиДляПотребностиВМеталлеЭталон = 	0;
        			КонецЕсли;  
        			
        			#КонецОбласти                                           
        			
        			//Марка    
        			Если СтрНайти(Строка(Структ.Марка),"Стренга медная ТПЖ") Тогда
        				НоваяМаркаЗаказаИзЕРП = Структ.Марка;
        				НоваяМаркаЗаказа = "Стренга медная ТПЖ";
        			ИначеЕсли Структ.Марка= "Проволока медная" Тогда  
        				НоваяМаркаЗаказаИзЕРП = Структ.Марка; 
        				НоваяМаркаЗаказа = "Проволока медная"; 
        			Иначе
        				Если НовыйДокумент.ДобавленИзЕРП тогда
        					Если НовыйДокумент.ПлюсовойКабель Тогда
        						НоваяМаркаЗаказаИзЕРП = Структ.Марка+" "+ Структ.КоличествоЖил + "х" + Структ.Сечение+"+"+Структ.КоличествоЖилПлюсовой+"х"+Структ.СечениеПлюсовой;
        					Иначе
        						НоваяМаркаЗаказаИзЕРП= Структ.Марка + " " + Структ.КоличествоЖил + "х" + Структ.Сечение;
        					КонецЕсли;	
        				Иначе
        					Если НовыйДокумент.ПлюсовойКабель Тогда
        						НоваяМаркаЗаказаИзЕРП = Структ.Марка;
        					Иначе
        						НоваяМаркаЗаказаИзЕРП= Структ.Марка + " " + Структ.КоличествоЖил + "х" + Структ.Сечение;
        					КонецЕсли;	
        				КонецЕсли;
        			КонецЕсли;     
        			//марка
        			НовыйДокумент.МаркаЗаказаИзЕРП=НоваяМаркаЗаказаИзЕРП;
        			НовыйДокумент.МаркаЗаказа = ?(НоваяМаркаЗаказа = Null,НоваяМаркаЗаказа,НовыйДокумент.МаркаЗаказа);                          
        			структ.Марка = НовыйДокумент.МаркаЗаказа;   
        			//		
        			//Цвета
        			НовыйДокумент.ЦветаЗаказа.Загрузить(ПолучитьЦветаИзСправочника(Структ));   	 	 
        			//Надо внести информацию в справочник при его открытии пользователем (Модуль формы объекта При Открытии)
        			
        			//тех цепочки
        			ЕстьЗапись = Ложь;
        			ТчОборудование = НовыйДокумент.ЭтапыИОборудование;
        			ТчОборудованиеЭталон = НовыйДокумент.ЭтапыИОборудованиеЭталон;
        			
        			Если НовыйДокумент.ВариантИсполнения.Наименование = "Монашов" Тогда                            
        				НайтиТехЦепочку_НОВАЯ(структ.Марка,ПараметрыКабеля, ТчОборудованиеЭталон,"Производственная");
        			Иначе
        				НайтиТехЦепочку_НОВАЯ(структ.Марка,ПараметрыКабеля, ТчОборудованиеЭталон,"Эталон");
        			КонецЕсли;
        			
        			ЕстьЗапись=НайтиТехЦепочку_НОВАЯ(структ.Марка,ПараметрыКабеля,ТчОборудование,"Производственная");
        			Если Структ.ПлюсовойКабель тогда
        				ТчОборудование.Сортировать("ПлюсовойКабель Возр");
        				ТчОборудованиеЭталон.Сортировать("ПлюсовойКабель Возр");
        			КонецЕсли;  
        			НовыйДокумент.ЭтапыИОборудование.Загрузить(ТчОборудование.Выгрузить());          		
        			НовыйДокумент.ЭтапыИОборудованиеЭталон.Загрузить(ТчОборудованиеЭталон.Выгрузить());  
        			
        		КонецЕсли;
        	КонецЕсли;
        	НовыйДокумент.Записать();               
        	НашДокумент = Документы.ЗаказыВПроизводство.НайтиПоНомеру(НовыйДокумент.Номер).ПолучитьОбъект();	
        	НашДокумент.Записать();
        	Если НашДокумент.Тип = Перечисления.ТипПродукции.Отходы или  НашДокумент.Тип = Перечисления.ТипПродукции.Полуфабрикат тогда //отходы
        		ДобавлениеПроверкаИОтправкаОтходов(НашДокумент.Ссылка);
        	КонецЕсли;	
        	
        	
        КонецПроцедуры
</details>

## Процедура СозданиеДокументаЦПМ(Структ) Экспорт 

<details>
  <summary>
    Код
  </summary>
  
        НовыйДокумент = Документы.ЗаказыВПроизводствоЦПМ.СоздатьДокумент(); 
        	//IDZak   
        	НовыйДокумент.Дата = ТекущаяДата();
        	НовыйДокумент.IDZak = ФормированиеIDZak("");  
        	Структ.вставить("idzak",НовыйДокумент.IDZak);
        	НовыйДокумент.НомерСчета= Структ.НомерСчёта;
        	НовыйДокумент.НоменклатураERP = Структ.Заказ;    
        	//Данилова 27.09
        	
        	Если СтрНайти(Структ.Заказ, "(м)")>0 тогда 
        		Шина=СтрЗаменить(Структ.Заказ, " (м)", "");
        		НовыйДокумент.Продукция=Справочники.ШиныЦПМ.НайтиПоНаименованию(Шина);		
        	КонецЕсли;	                                                              
        	Если СтрНайти(Структ.Заказ, "(кг)")>0 тогда 
        		Шина=СтрЗаменить(Структ.Заказ, " (кг)","");
        		НовыйДокумент.Продукция=Справочники.ШиныЦПМ.НайтиПоНаименованию(Шина);		
        	КонецЕсли;
        	//-Данилова
        	НовыйДокумент.Менеджер = Структ.Менеджер;         
        	НовыйДокумент.Длина    = 4;  
        	
        	МассивРазмера = СтрРазделить(строка(Структ.Заказ)," ");
        		Для каждого Названия из МассивРазмера Цикл
        			Если СтрНайти(Названия, "х") > 0 тогда
        				Размер = Названия; 	
        			КонецЕсли;		
        		КонецЦикла;
        		
        	Позиция=СтрНайти(Размер,"х");   
        		
        	НовыйДокумент.Высота = Лев(Размер, Позиция-1);         
        	НовыйДокумент.Ширина = Прав(Размер, СтрДлина(Размер)-Позиция);         
        	НовыйДокумент.ДатаВыходаПоПлану= Структ.ДатаВыходаПоЗаказу;         
        	НовыйДокумент.Цвет = Структ.Цвет;
        	НовыйДокумент.Статус = Перечисления.СтатусыПроизводства.Вграфике;    
        	НовыйДокумент.ЕдиницаИзмеренияЗаказа = Структ.ЕдиницаИзмеренияЗаказа;
        	НовыйДокумент.Примечание=Структ.Комментарий;     
        	НовыйДокумент.ПримечаниеДляПлановика=Структ.Комментарий+Структ.Намотка;
        	ДлинаЗаказа = Число(Структ.ДлинаЗаказа);
        	Если СтрНайти(нрег(НовыйДокумент.НоменклатураERP),"пруток") или СтрНайти(нрег(НовыйДокумент.НоменклатураERP),"катанка") тогда
        		НовыйДокумент.Ширина = ?(Структ.Сечение=0,1,Структ.Сечение);         
        		НовыйДокумент.Высота = ?(Структ.Сечение=0,1,Структ.Сечение);         
        	КонецЕсли;
        	
        	НовыйДокумент.КоличествоПоЗаказу = ДлинаЗаказа;      
        	Площадь=НовыйДокумент.Высота*НовыйДокумент.Ширина;
        	
        	Если НовыйДокумент.ЕдиницаИзмеренияЗаказа = Перечисления.ЕдиницаИзмеренияЗаказа.Кг тогда     
        		
        		Если (ДлинаЗаказа>=2000) и (ДлинаЗаказа <3500) и (Площадь <=0.00016) тогда
        			 МассаСТолерансом = ДлинаЗаказа*1.04;           
        			НовыйДокумент.УчтенныйТолеранс = 4;
        		ИначеЕсли	ДлинаЗаказа <2000 тогда
        			МассаСТолерансом = ДлинаЗаказа*1.05;           
        			НовыйДокумент.УчтенныйТолеранс = 5;
        		ИначеЕсли ДлинаЗаказа >=2000 и	ДлинаЗаказа <10000 тогда
        			МассаСТолерансом = ДлинаЗаказа*1.03;                                   
        			НовыйДокумент.УчтенныйТолеранс = 3;
        		Иначе
        			МассаСТолерансом = ДлинаЗаказа;
        		КонецЕсли;
        			
        		
        		
        		ДлинаВМетрах=Окр(ДлинаЗаказа/0.008989/(НовыйДокумент.Высота*НовыйДокумент.Ширина));  
        		КоличествоШин=Окр(ДлинаВметрах/НовыйДокумент.Длина)-1; 
        		ДлинаВМетрах=КоличествоШин*НовыйДокумент.Длина;
        		
        		Пока ДлинаЗаказа<МассаСТолерансом цикл
        			КоличествоШин=КоличествоШин+1;
        			ДлинаВМетрах=КоличествоШин*НовыйДокумент.Длина;
        			ДлинаЗаказа=ДлинаВМетрах*0.008989*(НовыйДокумент.Высота*НовыйДокумент.Ширина); 			
        		КонецЦикла;    
        		
        		Если ДлинаЗаказа>МассаСТолерансом тогда
        			КоличествоШин=КоличествоШин-1;
        			ДлинаВМетрах=КоличествоШин*НовыйДокумент.Длина;
        			ДлинаЗаказа=ДлинаВМетрах*0.008989*(НовыйДокумент.Высота*НовыйДокумент.Ширина); 			
        		КонецЕсли;
        		//Длина = ДлинаЗаказа;  
        		Если (МассаСТолерансом-ДлинаЗаказа)/ДлинаЗаказа>0.15 тогда
        			КоличествоШин=КоличествоШин+1;
        			ДлинаВМетрах=КоличествоШин*НовыйДокумент.Длина;
        			ДлинаЗаказа=ДлинаВМетрах*0.008989*(НовыйДокумент.Высота*НовыйДокумент.Ширина); 			
        		КонецЕсли;
        		
        	Иначе                           
        		
        		ДлинаМ = ДлинаЗаказа;  
        	КонецЕсли;  
        	
        	
        	
        	 
        	 
        	//++Данилова 06.10
        	Если НовыйДокумент.ЕдиницаИзмеренияЗаказа = Перечисления.ЕдиницаИзмеренияЗаказа.М тогда    
        		 НовыйДокумент.ЗаданиеКМ=ДлинаМ;
        		 НовыйДокумент.ЗаданиеКГ=ДлинаМ*0.008989*(НовыйДокумент.Высота*НовыйДокумент.Ширина);
        		 НовыйДокумент.Задание=ДлинаМ/4;  
        		 НовыйДокумент.ЗаданиеЗаготовкиКм=ДлинаМ;
        		 НовыйДокумент.ЗаданиеЗаготовкиКг=ДлинаМ*0.008989*(НовыйДокумент.Высота*НовыйДокумент.Ширина);
        		 НовыйДокумент.ЗаданиеЗаготовкиШт=ДлинаМ/4;  
        	 ИначеЕсли НовыйДокумент.ЕдиницаИзмеренияЗаказа = Перечисления.ЕдиницаИзмеренияЗаказа.Кг тогда
        		 НовыйДокумент.Задание=КоличествоШин;
        			НовыйДокумент.ЗаданиеКМ=КоличествоШин*НовыйДокумент.Длина;
        			НовыйДокумент.ЗаданиеКг=НовыйДокумент.ЗаданиеКМ*0.008989*(НовыйДокумент.Высота*НовыйДокумент.Ширина); 
        			НовыйДокумент.ЗаданиеЗаготовкиШт=КоличествоШин;  
        			НовыйДокумент.ЗаданиеЗаготовкиКм=КоличествоШин*НовыйДокумент.Длина;
        			НовыйДокумент.ЗаданиеЗаготовкиКг=НовыйДокумент.ЗаданиеКМ*0.008989*(НовыйДокумент.Высота*НовыйДокумент.Ширина);       		 
        	  КонецЕсли;  
        	 НовыйДокумент.ПометкаУдаления=Ложь;
        	///-Данилова    
        	НовыйДокумент.Записать(); 
        	
        	////++Минайкин 29.09.23
        	//Если СтрНайти(нрег(НовыйДокумент.НоменклатураERP),"шина") Тогда
        	//	Запрос = Новый Запрос;
        	//	Запрос.Текст = 
        	//	"ВЫБРАТЬ
        	//	|	ЗаказыВПроизводствоЦПМ.НоменклатураERP КАК НоменклатураERP,
        	//	|	ЗаказыВПроизводствоЦПМ.Ссылка КАК Ссылка,
        	//	|	ЗаказыВПроизводствоЦПМ.Задание КАК Задание,
        	//	|	ЗаказыВПроизводствоЦПМ.ДатаВыходаПоПлану КАК ДатаВыходаПоПлану,
        	//	|	ЗаказыВПроизводствоЦПМ.НомерСчета КАК НомерСчета,
        	//	|	ЗаказыВПроизводствоЦПМ.Примечание КАК Примечание
        	//	|ИЗ
        	//	|	Документ.ЗаказыВПроизводствоЦПМ КАК ЗаказыВПроизводствоЦПМ
        	//	|ГДЕ
        	//	|	ЗаказыВПроизводствоЦПМ.НомерСчета ПОДОБНО &НомерСчета";
        	//	
        	//	ПозицияСлэш = СтрНайти(Структ.НомерСчёта, "/");
        	//	НомерСчёта = Лев(Структ.НомерСчёта, ПозицияСлэш - 1); 
        	//	
        	//	Запрос.УстановитьПараметр("НомерСчета", НомерСчёта + "%");
        	//	
        	//	РезультатЗапроса = Запрос.Выполнить();
        	//	
        	//	Если РезультатЗапроса.Выгрузить().Количество() = Структ.ВсегоПозицийВЗаказе Тогда 
        	//		РазбивкаЗаказаДляЗаполненияВКоробки(РезультатЗапроса.Выгрузить());
        	//		//СозданиеДокументаСборкиКоробок(РезультатЗапроса.Выгрузить(), НомерСчёта);
        	//		СозданиеПозицийСгруппированныхЗаказовСклада(РезультатЗапроса.Выгрузить(), НомерСчёта);
        	//	КонецЕсли; 
        	//КонецЕсли;
        	////--
         КонецПроцедуры


	
 </details>

	
	
## Функция НахождениеКодаФункцииРассчётаМатериалов(КодФуРасМат, НазваниеОборудованияНаше, ВидОперации, НазваниеОборудованияВСправочнике) Экспорт

<details>
  <summary>
    Код
  </summary>

	Если Строка(ВидОперации) = "" Тогда
		НазваниеОборудованияВСправочнике = Справочники.НоменклатураОборудований.НайтиПоНаименованию(НазваниеОборудованияНаше);
		КодФуРасМат = НазваниеОборудованияВСправочнике.КодФункцииРассчётаМатериалов;
	Иначе
		Если ВидОперации = Перечисления.ВидОперации.ОбмоткаАлюмофлексом Тогда 
			КодФуРасМат = 1;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОбмоткаБроней Тогда 
			КодФуРасМат = 2;			
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.Волочение Тогда 
			КодФуРасМат = 3;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.Заполнение Тогда 
			КодФуРасМат = 4;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.Изоляция Тогда 
			КодФуРасМат = 5;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОболочкаКруглый Тогда 
			КодФуРасМат = 6;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ЗаполнениеИОболочка Тогда 
			КодФуРасМат = 21;	
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОболочкаПлоский Тогда 
			КодФуРасМат = 7;	
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОбщаяСкрутка Тогда 
			КодФуРасМат = 8;	
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.СкруткаТПЖ Тогда 
			КодФуРасМат = 9;	
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.Обмотка1Слой Тогда 
			КодФуРасМат = 11;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ВолочениеМультивайер Тогда 
			КодФуРасМат = 12;	
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.СкруткаСтренги Тогда 
			КодФуРасМат = 13;		
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.Обмотка2Слоя Тогда 
			КодФуРасМат = 15;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОбмоткаПроволочнойБронёй Тогда 
			КодФуРасМат = 16;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОбмоткаПроволочнымЭкраном Тогда 
			КодФуРасМат = 17;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОбщаяСкрутка6кВ Тогда 
			КодФуРасМат = 18;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОболочкаШлангом Тогда
			КодФуРасМат = 19;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОболочкаПлоскийШлангом Тогда
			КодФуРасМат = 20;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОболочкаПлоскийШлангом Тогда
			КодФуРасМат = 21;
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.Изоляция3слоя Тогда
			КодФуРасМат = 22;  
			//Миликен			
			//Шахтный
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.Изоляция2слоя Тогда
			КодФуРасМат = 30;    
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ИзготовлениеСердечника Тогда
			КодФуРасМат = 31;    
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ОбщаяСкруткаСЛентообмоткой Тогда
			КодФуРасМат = 32;   
		ИначеЕсли ВидОперации = Перечисления.ВидОперации.ИзоляцияСердечника Тогда
			КодФуРасМат = 33;  	
			//
		Иначе
			Сообщить("Не найден вид операции");
		КонецЕсли;
	КонецЕсли;	
	Возврат КодФуРасМат;	
	КонецФункции


</details>
